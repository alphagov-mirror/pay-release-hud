<html>
<head>
  <meta http-equiv="refresh" content="60">
  <link rel=stylesheet type=text/css href="{{ url_for('static', filename='hud.css') }}">
  <title>Release HUD</title>
</head>

<body>
  <table id="releases">
    <colgroup>
      <col span="2">
    </colgroup>
    
    <colgroup>
      <col span="3">
    </colgroup>
    
    <colgroup>
      <col span="2">
    </colgroup>
    
    <tr>
      <th colspan="2" class="releases">
        Releases
      </td>
      
      <th colspan="3" class="staging">
        Deployed on Staging
      </td>
      
      <th colspan="2" class="production">
        Deployed on Production
      </th>
    </tr>
    
    <tr>
      <td class="category releases">New Releases</td>
      <td class="category releases">Approved for Staging</td>
      <td class="category staging">Awaiting Approval for Production</td>
      <td class="category staging">Approved for Production</td>      
      <td class="category staging">Promoted to Production</td>
      <td class="category production">Behind Staging</td>
      <td class="category production">Looks Good!</td>
    </tr>
    
    <tr>
      <td class="releases">
        {% for release in stages[Stages.RELEASE_CREATED] %}
            <div class="release {{release.repo.name}}">{% include 'release.html' %}</div>
        {% endfor %}
      </td>
      
      <td class="releases">
        {% for release in stages[Stages.RELEASE_APPROVED] %}
            <div class="release {{release.repo.name}} ok">{% include 'release.html' %}</div>
        {% endfor %}
      </td>
      
      <td class="staging">
        {% for release in stages[Stages.STAGING_DEPLOYED] %}
            <div class="release {{release.repo.name}} warning">{% include 'release.html' %}</div>
        {% endfor %}
      </td>
      
      <td class="staging">
        {% for release in stages[Stages.STAGING_APPROVED] %}
            <div class="release {{release.repo.name}} ok">{% include 'release.html' %}</div>
        {% endfor %}
      </td>
      
      <td class="staging">
        {% for release in stages[Stages.STAGING_PROMOTED] %}
            <div class="release {{release.repo.name}}">{% include 'release.html' %}</div>
        {% endfor %}
      </td>
      
      <td class="production">        
        {% for release in stages[Stages.PRODUCTION_BEHIND] %}
            <div class="release {{release.repo.name}}{% if loop.length > 1 %} alarm{% else %} warning{% endif %}">
              {% include 'release.html' %}</div>
        {% endfor %}
      </td>

      <td class="production">
        {% for release in stages[Stages.PRODUCTION_DEPLOYED] %}
            <div class="release {{release.repo.name}}">{% include 'release.html' %}</div>
        {% endfor %}
      </td>
    </tr>
  </table>

</body>
</html>